# 集計プログラム

このプログラムは、Excelファイルからデータを読み込み、指定した科目・年度・所属に基づいて月別の得点を集計し、結果をExcelファイルに出力します。

## 主な機能
- **年月日のデータ形式**: 入力ファイルの「年月日」列が `YYYY/MM/DD` フォーマットであることを前提としています。
- **データのフィルタリング**: 指定された科目、年度、所属のデータを抽出します。
- **年度の範囲指定**: 4月〜翌年3月を1つの年度として扱います。
- **月別得点の集計**: 氏名ごとに月別得点を計算し、年間合計も含めて出力します。
- **Excelファイルへの出力**: 集計結果を指定されたフォーマットでExcelファイルとして保存します。

---

## 必要要件
- **Python 3.7以上**
- **ライブラリ**:
  - `pandas`
  - `openpyxl`

必要なライブラリは以下のコマンドでインストールしてください。

```bash
pip install pandas openpyxl
```

---

## 入力ファイル
### フォーマット
入力ファイルは以下の形式を持つExcelファイルである必要があります（`Sheet1`シートを読み取ります）。

| 氏名   | 科目   | 所属 | 年月日       | 得点 |
|--------|--------|------|--------------|------|
| 山田太郎 | 数学   | A    | 2024/04/15   | 80   |
| 佐藤花子 | 英語   | B    | 2024/05/10   | 90   |

- **氏名**: 学生の名前。
- **科目**: 対象科目（例: 数学、英語）。
- **所属**: 所属クラスやグループ。
- **年月日**: `YYYY/MM/DD` 形式の日付。
- **得点**: 月ごとの得点。

---

## 実行方法
1. プログラムのファイル（例: `sum_hour_c.py`）を適切な場所に保存します。
2. 入力ファイル（例: `input_file.xlsx`）を指定されたフォルダに保存します。
3. 以下のコマンドを実行します。

```bash
python sum_hour_c.py
```

4. プログラムは以下の入力を求めます:
   - **科目**: 集計したい科目名を入力します（例: 数学）。
   - **年度**: 集計したい年度を入力します（例: 2024）。
   - **所属**: 集計したい所属を入力します（例: A）。

5. 実行結果は指定フォルダに以下の形式で保存されます。

```plaintext
output_{科目}_{年度}_{所属}.xlsx
```

例: `output_数学_2024_A.xlsx`

---

## 出力ファイル
### フォーマット
出力ファイルは以下の形式で保存されます。

| 氏名   | 4月 | 5月 | 6月 | 7月 | 8月 | 9月 | 10月 | 11月 | 12月 | 1月 | 2月 | 3月 | 年間合計 | 科目   | 年度 | 所属 |
|--------|-----|-----|-----|-----|-----|-----|------|------|------|-----|-----|-----|----------|--------|------|------|
| 山田太郎 | 80  | 90  | 85  | 75  | 95  | 80  | 85   | 88   | 92   | 78  | 84  | 89  | 1031     | 数学   | 2024 | A    |
| 合計   | 80  | 90  | 85  | 75  | 95  | 80  | 85   | 88   | 92   | 78  | 84  | 89  | 1031     | 数学   | 2024 | A    |

---

## 注意事項
1. 入力ファイルのフォーマットが異なる場合、プログラムは正しく動作しません。
2. ワーニングが出る場合、データの形式や入力に問題がないか確認してください。
3. 必要に応じてパスや設定を変更してください。

---
