# Excel データ解析プログラム

このプログラムは、指定されたExcelファイルからデータを読み込み、ユーザー入力に基づいて特定の科目、年度、所属のデータをフィルタリングし、月別得点を集計して結果を新しいExcelファイルに書き出します。

## 必要なライブラリ

以下のPythonライブラリが必要です：

- `pandas` (データ処理のため)
- `time` (処理時間の計測のため)
- `xlsxwriter` (高速なExcelファイル書き込みのため)

インストール方法：
```bash
pip install pandas xlsxwriter
```

## 使用方法

1. **Excelファイルの準備**:
   - プログラムは指定されたパスにあるExcelファイル（例：`input_file.xlsx`）を読み込みます。
   - ファイルには、少なくとも以下のカラムが必要です：`年月日`、`科目`、`所属`、`氏名`、`得点`。

2. **ユーザー入力**:
   プログラムは次の情報を求めます：
   - **dateフォーマット**：Excelファイルの日付フォーマットを入力します（例：`%m-%d-%y`、`%Y/%m/%d`など）。
   - **科目**：出力したい科目（例：`国語`、`数学`、`英語`など）。
   - **年度**：出力したい年度（例：`2024`）。
   - **所属**：出力したい所属（例：`D`、`A`など）。

3. **処理の流れ**:
   - 指定されたExcelファイルを読み込み、`年月日`列を指定されたフォーマットで変換。
   - 入力された年度と所属、科目に基づいてデータをフィルタリングします。
   - 月別得点の集計を行い、年度と月ごとの得点を算出します。
   - 最後に、月別得点を集計し、年間合計を計算した結果を新しいExcelファイルに書き出します。

4. **出力結果**:
   - 結果は、指定された科目、年度、所属に基づいてファイル名が命名されたExcelファイル（例：`output_数学_2024_D.xlsx`）に出力されます。
   - 結果のExcelファイルには、各生徒ごとの月別得点（4月～翌年の3月）、年間合計が表示されます。

## サンプル入力と出力

### 入力例:
- **dateフォーマット**：`%Y/%m/%d`
- **科目**：`数学`
- **年度**：`2024`
- **所属**：`D`

### 出力例:
- 出力ファイル：`output_数学_2024_D.xlsx`
- 出力内容：
  - 生徒名
  - 各月（4月～翌年の3月）の得点
  - 年間合計
  - 科目、年度、所属の情報

## 処理時間

プログラムは、ファイルの読み込み時間、データフィルタリングおよび分析時間をコンソールに表示します。処理が完了すると、結果を新しいExcelファイルに書き出します。

## 注意点

- 年度は数字で入力してください。
- 入力した年度、科目、所属に該当するデータがない場合は、プログラムがその旨を表示し終了します。
- ファイルの読み込み時にエラーが発生した場合は、パスやファイル名を確認してください。

## ライセンス

MIT License
