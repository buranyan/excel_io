Version 4
SHEET 1 1588 1408
WIRE -928 -240 -960 -240
WIRE -48 -224 -112 -224
WIRE -112 -208 -112 -224
WIRE -960 -192 -960 -240
WIRE -464 -192 -496 -192
WIRE -352 -192 -368 -192
WIRE -336 -192 -352 -192
WIRE -208 -192 -240 -192
WIRE -112 -112 -112 -128
WIRE -960 -96 -960 -112
WIRE -352 -96 -352 -192
WIRE -336 -96 -352 -96
WIRE -208 -96 -240 -96
WIRE -48 -80 -112 -80
WIRE -112 -64 -112 -80
WIRE -928 0 -960 0
WIRE -112 32 -112 16
WIRE -960 48 -960 0
WIRE -48 64 -112 64
WIRE -112 80 -112 64
WIRE -960 144 -960 128
WIRE -112 176 -112 160
WIRE -736 384 -768 384
WIRE -624 384 -624 336
WIRE -624 384 -640 384
WIRE -608 384 -624 384
WIRE -496 384 -512 384
WIRE -480 384 -496 384
WIRE -368 384 -368 304
WIRE -368 384 -384 384
WIRE -352 384 -368 384
WIRE -240 384 -256 384
WIRE -128 384 -144 384
WIRE -16 384 -32 384
WIRE 96 384 80 384
WIRE 112 384 96 384
WIRE 224 384 208 384
WIRE 336 384 320 384
WIRE 448 384 432 384
WIRE 560 384 544 384
WIRE 672 384 656 384
WIRE 800 384 768 384
WIRE -496 448 -496 384
WIRE 96 464 96 384
WIRE 384 464 384 432
WIRE 384 464 96 464
WIRE -832 496 -864 496
WIRE -304 496 -304 432
WIRE -256 496 -304 496
WIRE 32 496 32 432
WIRE 80 496 32 496
WIRE -688 512 -688 432
WIRE -688 512 -736 512
WIRE -672 512 -688 512
WIRE -832 528 -864 528
WIRE -832 560 -864 560
WIRE -832 592 -864 592
WIRE 560 608 512 608
WIRE 80 624 32 624
WIRE 512 640 512 608
WIRE 32 656 32 624
WIRE -688 704 -704 704
WIRE -640 704 -688 704
WIRE -432 704 -496 704
WIRE -368 704 -432 704
WIRE -240 704 -272 704
WIRE -208 704 -240 704
WIRE -80 704 -112 704
WIRE -48 704 -80 704
WIRE -832 736 -864 736
WIRE -688 736 -736 736
WIRE -640 736 -688 736
WIRE 512 736 512 720
WIRE -240 752 -240 704
WIRE 32 752 32 736
WIRE -832 768 -864 768
WIRE -688 768 -736 768
WIRE -640 768 -688 768
WIRE -640 800 -672 800
WIRE 80 800 32 800
WIRE 32 832 32 800
WIRE -672 864 -672 800
WIRE -240 864 -240 752
WIRE -240 864 -672 864
WIRE 32 928 32 912
WIRE -704 960 -720 960
WIRE -640 960 -704 960
WIRE -432 960 -496 960
WIRE -368 960 -432 960
WIRE -240 960 -272 960
WIRE -208 960 -240 960
WIRE -80 960 -112 960
WIRE -48 960 -80 960
WIRE 80 976 32 976
WIRE -704 992 -720 992
WIRE -640 992 -704 992
WIRE -240 1008 -240 960
WIRE 32 1008 32 976
WIRE -640 1024 -720 1024
WIRE -640 1056 -672 1056
WIRE 32 1104 32 1088
WIRE -672 1120 -672 1056
WIRE -240 1120 -240 1008
WIRE -240 1120 -672 1120
FLAG -256 496 th1
FLAG 80 496 th1dt1
FLAG 32 1104 0
FLAG 80 976 th2deg
FLAG -688 736 tha
FLAG -688 768 fn
FLAG -688 704 tq
FLAG -432 704 th1dt2m
FLAG -704 960 tha
FLAG -704 992 fn
FLAG -432 960 th2dt2m
FLAG -80 704 th1
FLAG -80 960 th2
FLAG -240 752 th1dt1
FLAG -240 1008 th2dt1
FLAG -864 736 th1
FLAG -864 768 th2
FLAG 800 384 tq
FLAG -864 496 COS
FLAG -864 528 SIN
FLAG -624 336 el_cmd_deg
FLAG -496 448 el_cmd_rad
FLAG -368 304 mtr_rad
FLAG 32 928 0
FLAG 80 800 th2dt1deg
FLAG 32 752 0
FLAG 80 624 th2dt2deg
FLAG -960 144 0
FLAG -352 -96 az_p_deg
FLAG -208 -192 COS
FLAG -208 -96 SIN
FLAG -928 0 az_v_rotate_deg
FLAG -112 -112 0
FLAG -112 32 0
FLAG -48 -224 theta_pitch
FLAG -48 -80 phi_roll
FLAG -864 560 theta_pitch
FLAG -864 592 phi_roll
FLAG -768 384 elev_ang
FLAG -112 176 0
FLAG -48 64 elev_ang
FLAG -720 1024 th2
FLAG 512 736 0
FLAG 560 608 cos_th2
FLAG -960 -96 0
FLAG -928 -240 az_v_sector_deg
FLAG -672 512 el_calc_deg
FLAG -496 -192 az_v_sector_deg
SYMBOL bv 32 992 R0
SYMATTR InstName B5
SYMATTR Value V=V(th2) / pi * 180 / gretio_el
SYMBOL mysym/f_gen -784 752 R0
SYMATTR InstName U12
SYMBOL mysym/th1dt2 -592 720 R0
SYMATTR InstName U11
SYMBOL add 384 384 R0
SYMATTR InstName U2
SYMBOL integ -320 704 R0
SYMATTR InstName U5
SYMBOL integ -160 704 R0
SYMATTR InstName U6
SYMBOL integ -320 960 R0
SYMATTR InstName U7
SYMBOL integ -160 960 R0
SYMATTR InstName U8
SYMBOL kpp -192 384 R0
SYMATTR InstName U10
SYMBOL v_lim -80 384 R0
SYMATTR InstName U14
SYMBOL integ 160 384 R0
SYMATTR InstName U15
SYMBOL kvi 272 384 R0
SYMATTR InstName U16
SYMBOL kvp 496 384 R0
SYMATTR InstName U17
SYMBOL t_gen 608 384 R0
SYMATTR InstName U18
SYMBOL t_lim 720 384 R0
SYMATTR InstName U22
SYMBOL mysym/sub -304 384 R0
SYMATTR InstName U24
SYMBOL mysym/sub 32 384 R0
SYMATTR InstName U25
SYMBOL mysym/elev_calc -784 512 R0
SYMATTR InstName U1
SYMBOL mysym/deg_to_rad -560 384 R0
SYMATTR InstName U3
SYMBOL mysym/th2dt2_el -592 976 R0
SYMATTR InstName U9
SYMBOL bv 32 816 R0
SYMATTR InstName B1
SYMATTR Value V=V(th2dt1) / pi * 180 / gretio_el
SYMBOL bv 32 640 R0
SYMATTR InstName B2
SYMATTR Value V=V(th2dt2m) / pi * 180 / gretio_el
SYMBOL voltage -960 32 R0
WINDOW 3 -23 -69 Left 2
SYMATTR Value PULSE(0 {azv_deg} 1 {ta} {ta} {tc})
SYMATTR InstName V1
SYMBOL integ -416 -192 R0
SYMATTR InstName U13
SYMBOL mysym/cos_gen -288 -192 R0
SYMATTR InstName U19
SYMBOL mysym/sin_gen -288 -96 R0
SYMATTR InstName U20
SYMBOL mysym/gear_el -432 384 R0
SYMATTR InstName U21
SYMBOL voltage -112 -224 R0
SYMATTR InstName V2
SYMATTR Value PULSE(0 0 1 1u 1u 25)
SYMBOL voltage -112 -80 R0
SYMATTR InstName V3
SYMATTR Value PULSE(0 20 1 1u 1u 25)
SYMBOL voltage -112 64 R0
SYMATTR InstName V4
SYMATTR Value PULSE(0 -20 1 1u 1u 25)
SYMBOL bv 512 624 R0
SYMATTR InstName B3
SYMATTR Value V=cos(V(th2)/ gretio_el)
SYMBOL voltage -960 -208 R0
WINDOW 3 -28 -73 Left 2
SYMATTR Value PWL(0 0 1 0 {1+ta} {azv_deg/2} {1+2*ta} 0 {1+3*ta} {-azv_deg} {1+5*ta} {azv_deg} {1+6*ta} 0 {1+7*ta} {-azv_deg/2} {1+8*ta} 0)
SYMATTR InstName V5
SYMBOL add -688 384 R0
SYMATTR InstName U4
TEXT 216 -224 Left 2 !.tran 30\n.ic V(th1)=0 V(th1dt1)=0 V(th2)=0 V(th2dt1)=0   \n.param kpp=30 kvp=90 kvi=30\n.param v_lim=5000/60*2*pi v_min=-v_lim v_max=v_lim\n.param t_lim=0.038 t_min=- t_lim t_max=t_lim\n.param gretio_el=480 owntq=2.51/gretio_el\n.param JM=6.4*10**-7 DM=1.0*10**-5\n.param JL=0.0613/gretio_el**2 DL=0.005/gretio_el**2\n.param kgb=1000 dbdeg=0.1 dbrad=dbdeg*pi/180\n.param azv_deg=36 aza_deg=21.6 ta=azv_deg/aza_deg\n.param tp=20 tc=tp-ta
